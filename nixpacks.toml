[phases.setup]
nixPkgs = ["nginx"]

[phases.install]
cmds = [
  "mkdir -p /etc/nginx /var/log/nginx /var/cache/nginx"
]

[phases.build]
dependsOn = ["install"]
cmds = [
  "cp nginx.conf /etc/nginx/nginx.conf",
  "ls -la /app/assets/plaque-platinum.svg || echo 'Platinum file missing'",
  "cat /app/assets/plaque-platinum.svg || echo 'Cannot read platinum file'",
  "chmod -R 755 /app"
]

[start]
cmd = "nginx -g 'daemon off;'"