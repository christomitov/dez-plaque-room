server {
    listen 80;
    server_name _;
    root /usr/share/nginx/html;
    index index.html;

    # Don't cache by default
    add_header Cache-Control "no-cache";

    # Remove any X-Forwarded-Proto header that might be present
    proxy_set_header X-Forwarded-Proto "";

    # Handle HTTPS redirects
    set $forwarded_proto $http_x_forwarded_proto;
    if ($http_cf_visitor ~ '.*https.*') {
        set $forwarded_proto https;
    }

    # Prevent redirect loops
    if ($forwarded_proto = "https") {
        set $redirect_to_https "no";
    }

    location / {
        try_files $uri $uri/ /index.html;
    }
}